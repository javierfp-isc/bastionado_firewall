version: '3.5'
services:
#Services
 wordpress:
  build:
    context: build
    args:
     ENVPATH: wordpress.env
  hostname: wordpress
  privileged: true
  networks:
   dmz:
    ipv4_address: 192.168.120.122
  volumes:
   - iptwordpress:/etc/iptables
   - wpmysql:/var/lib/mysql
 moodle:
  build:
    context: build
    args:
     ENVPATH: moodle.env
  hostname: moodle
  privileged: true
  networks:
   dmz:
    ipv4_address: 192.168.120.123
  volumes:
   - iptmoodle:/etc/iptables
   - moodmysql:/var/lib/mysql
 dvwa:
  build:
    context: build
    args:
     ENVPATH: dvwa.env
  hostname: dvwa
  privileged: true
  networks:
   dmz:
    ipv4_address: 192.168.120.124
  volumes:
   - iptdvwa:/etc/iptables
   - dvwamysql:/var/lib/mysql
networks:
  dmz:
    driver: bridge
    driver_opts:
     com.docker.network.bridge.name: firewall_dmz
    ipam:
     config:
       - subnet: 192.168.120.0/24
volumes:
 iptwordpress:
 iptmoodle:
 iptdvwa:
 wpmysql:
 moodmysql:
 dvwamysql:
